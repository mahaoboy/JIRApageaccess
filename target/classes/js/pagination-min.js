AJS.$(document).ready(function(){AJS.$("#fromdatepicker").datePicker({overrideBrowserDefault:true});AJS.$("#todatepicker").datePicker({overrideBrowserDefault:true})});AJS.$(document).ready(function(d){var a=AJS.params.baseURL;var e=AJS.I18n.getText("PageAccess.pagination.error");var c=AJS.I18n.getText("PageAccess.pagination.userNotExist");d(".pageList").each(function(){var k=d(this);var f={};d("fieldset input[class='param']",k).each(function(){f[this.name]=this.value});k.data("spaceAttachmentsCacheData",f);d(".pageAccess",k).live("click",function(){var m=d(this);var l=m.attr("clickedPage");f.pageNumber=l;h();return false});d(".spaceAttachmentsSortBy",k).live("click",function(){var l=d(this);var m=l.attr("sortBy");f.sortBy=m;f.pageNumber=1;h();return false});d("#removeFilterLink",k).live("click",function(){d("input[name='fromdatepicker']",k).val("");d("input[name='todatepicker']",k).val("");d("select[name='groupName']",k).val("");d("select[name='spaceName']",k).val("");d("input[name='userNameField']",k).val("");d("input[name='pageTitleField']",k).val("");f.fromDate="";f.toDate="";f.groupNameField="";f.spaceNameField="";f.userNameField="";f.pageTitleField="";f.pageNumber=1;f.totalItem=0;h();return false});d("#filter-save-button",k).live("click",function(){var p=d("input[name='fromdatepicker']",k).val();var o=d("input[name='todatepicker']",k).val();var n=d("select[name='groupName']",k).val();var q=d("select[name='spaceName']",k).val();var l=d("input[name='userNameField']",k).val();var m=d("input[name='pageTitleField']",k).val();g(p,o,n,q,l,m)});function i(l){var o=document.getElementById(l);var n=0;var m=0;do{n+=o.offsetLeft;m+=o.offsetTop}while(o=o.offsetParent);return[n,m]}var g=function(n,o,q,l,p,m){if(b(n)){f.fromDate=n}if(b(o)){f.toDate=o}if(b(q)){f.groupNameField=q}if(b(l)){f.spaceNameField=encodeURIComponent(l)}if(b(p)){f.userNameField=p}if(b(m)){f.pageTitleField=encodeURIComponent(m)}f.pageNumber=1;f.totalItem=0;if(p.length>0){j(p)}else{h()}return false};var h=function(){d.ajax({cache:false,data:k.data("spaceAttachmentsCacheData"),dataType:"html",success:function(l){var m=d(l);if(m.find(".attachments-container").length>0){d(".attachments-container",k).replaceWith(m.find(".attachments-container"));AJS.$("#fromdatepicker").datePicker();AJS.$("#todatepicker").datePicker();d(document).scrollTop(d("#SearchResult").offset().top)}else{location.reload()}},error:function(l,n,m){AJS.log("Error retrieving data: "+m);d(".attachments-container",k).remove();k.append('<div class="space-attachments-error error">'+e+"</div>")},type:"GET",url:a+"/plugins/servlet/winagile/pageaccessstatistics"})};var j=function(m){var l={};l.username=m;d.ajax({cache:false,data:l,dataType:"json",success:function(n){if(!b(n.errorMessages)){h();return false}else{alert(n.errorMessages);return false}},error:function(n,p,o){AJS.log("Error retrieving data: "+d.parseJSON(n.responseText).errorMessages);alert(d.parseJSON(n.responseText).errorMessages);return false},type:"GET",url:a+"/rest/api/2/user"})}});function b(f){if(typeof(f)!=undefined&&typeof(f)!=null&&typeof(f)!="undefined"){return true}else{return false}}});